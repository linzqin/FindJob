# 渗透八股文

## OWASP Top 10(Open Web Application Security Project)

- 开放web应用程序安全项目公开的10个最关键的web应用程序安全漏洞列表。

#### 2021

1. **失效的访问控制**
	
	- 常见的CWE包括：将敏感信息泄露给未经授权的参与者、通过发送的数据泄露敏感信息、跨站请求伪造（csrf）
	
	  - 每个用户在权限之内操作。失败的访问控制会导致未经授权的信息泄露、修改、销毁等；或在用户权限之外执行业务功能。主要分为「水平越权」和「垂直越权」
	   - 常见的访问控制脆弱点：违反最小特权或默认拒绝原则、特权提升、修改url（参数修改或强制浏览）等绕过访问控制检查。
	   - 预防：除公共资源默认拒绝访问、记录失败的访问控制、使用一次性的访问控制机制、对API和控制器的访问进行速度限制等。
2. **加密机制失效**
   - 是否明文（github测试开发代码）、密钥强度怎么样
   - 预防：不必要的敏感数据尽快清除、加密存储敏感、不用传统的ftp协议传输敏感
3. **注入攻击**
   - 没验证过滤清洗用户提供的数据、没有验证输入数据的合法性、直接将动态查询或无上下文感知转移的非参数化调用在解释器中使用
   - 关闭错误回显、使用成熟的WAF、使用安全的api（解释器原因）、白名单服务器输入验证（长度等）、查询中使用LIMIT或其他sql控件以确保不会大量披露
4. **不安全的设计**
   - 漏洞利用：支付逻辑、密码找回、验证码暴力破解、验证码重复使用、验证码客户端回显、验证码绕过
   - 需求和资源管理、安全设计、安全开发生命周期
   - 预防：建立安全的开发周期、使用安全设计模式的库、分层设计
5. **安全配置错误**
   - 由于不安全的默认配置、不完整的临时配置等造成。缺少安全加固、权限配置错误、安装了不必要的功能、默认账户密码、升级的系统没有开启最新的安全特性、应用软件已过期
   - 预防：加固过程、搭建最小化平台（不包含任何不必要文件）、最新的安全说明更新补丁。
   - ActiveMQ 信息泄露漏洞（CVE-2017-15709）
6. **自带缺陷和过时的组件**
   - 组件拥有和应用程序相同的权限，如果应用程序中含有已知漏洞的组件被攻击者利用，会破坏应用程序的防御，遭受攻击产生严重影响
   - 是否知道所用组件版本信息、是否不再支持或过时、没有定期漏扫或查看组件安全公告
   - 预防：移除不使用的依赖功能组件等、仅从官方处获取组件、监控那些不再维护的或不再发布安全补丁的组件和库
7. **身份识别和身份验证错误**
   - 通过错误使用应用程序的身份认证和会话管理功能，攻击者能破译密码、密钥或会话令牌
   - 风险点：允许暴力或自动化攻击、允许预设脆弱常见密码、脆弱无效的认证资讯回复或忘记密码的流程、使用明文或脆弱hash密码、url中泄露session（URL重写）、没有正确注销sessionID、会话ID使用时间过长
   - 预防：多因素认证防止自动化撞库或暴力破解、检查弱口令、限制或增加失败尝试的延迟、使用服务器端安全的内置的回话管理器
8. **软件和数据完整性故障**
   - 预防：验证软件和数据的来源且未被修改、确保未签名或者未加密的序列化数据不会在没有检查或者数字签名的情况下发送到不信任的客户端、确保使用安全工具验证组件是否存在已知漏洞。
9. **安全日志和监控故障**
   - 需要审计的事件未记录、日志只存在本地、警报阈值和响应升级过程不到位或无效。无法检测实时或者准实时的攻击，无法检测和警告
   - 预防：确保日志能被记录、确保日志是以方便使用的格式生成的、确保高价值交易被完整记录
10. **服务器请求伪造SSRF**
    - 服务器过于信任用户的url，没有做足够的检测或地址限制，使其可将服务器作为跳板机，访问内网或其他服务器。
    - 服务器提供了从其他服务器应用获取数据的功能，且没有对目标地址做过滤和限制。
    - **常用来进行**：端口扫描、攻击内网存在漏洞的服务、攻击web应用进行指纹识别及其中的漏洞、php安装了expect扩展，可以执行系统命令
    - **预防**：限制请求端口只能为web端口，只允许访问http和https请求、限制不能访问内网的ip防止对内网造成攻击、屏蔽返回的详细信息。
    - **无回显时怎么探测内网信息**：dnslog。把服务器返回的结果放在域名中，然后读dbs解析时的日志，获取信息。

## SQL注入

-  基于数据类型的分类：字符串型注入和整型注入
- SQL盲注：基于布尔、基于时间、基于报错
- 常见的检测字符： 单双引号、注释、与、或、非